
# **Product Requirements Document**

**Product name:** **BajoPrecio.mx**
**Tag-line:** *“Mexico’s 25 best tech deals—always current, always in MXN.”*

---

## 1. Product Overview

BajoPrecio.mx is a **curated bargain hub for tech & gaming hardware in Mexico**.
We automate the collection of offers, hand-pick the best, and notify users instantly via Telegram and a daily email digest—no app install required.

---

## 2. Goals & Success Metrics (first 90 days)

| Goal | KPI | Target |
| :--- | :--- | :--- |
| Demonstrate demand | Daily unique visitors | ≥ 500 |
| Validate curation value | % of outbound clicks from deals with score ≥ +10 | ≥ 70 % |
| Build push audience | Telegram subscribers | ≥ 1,000 (≥ 80 % open-rate) |
| Unlock Amazon PA-API | Qualifying Amazon sales | ≥ 3 (within 60 days) |

---

## 3. MVP Scope

| Module | Must-have | Excluded for MVP |
| :--- | :--- | :--- |
| **Automated ingestion** | A background job runs every 3 hours to:<br>1. Loop through a list of 6 RSS feed URLs.<br>2. For each feed, parse the items.<br>3. Check for duplicates by `url`.<br>4. **Use source-specific "mappers" (RegEx + string parsing) to extract `price`, `store`, and `image` from the title and content.**<br>5. Save new, valid items to the `Deal` table with `status="DRAFT"`. | Keepa price-history API (activates post-revenue).<br>Scraping websites directly (only using RSS/API feeds). |
| **Admin curation panel** | View drafts sorted by discount %; **Publish** / **Discard** buttons. | Bulk actions (future). |
| **Public feed** | ≤ 25 live deals, newest first; cards show title, store, MXN price, % off, thumbnail. | Infinite scroll. |
| **Deal detail** | Full description, affiliate link, deal vote buttons, comments (Markdown, single-level) with vote buttons. | Edit / delete comments. |
| **Auth & karma** | Email and Google (NextAuth); **karma is the net score of votes on a user's comments (+1 for upvote, -1 for downvote)**; monthly leaderboard with MX$ 200 Amazon gift card. | GitHub OAuth; Users submitting deals. |
| **Notifications** | Auto-post to Telegram channel `@BajoPrecioMX` on each publish; nightly top-10 email (SendGrid free tier). | Twitter auto-posting. |
| **Moderation** | Anonymous “Report”; ≥ 3 reports pushes deal to *Review*; admin can **Hide** and 30-day ban user. | Automatic hide on price change. |
| **Blog** | MDX posts written by founder; URL `/blog/<slug>`. | Scheduled publishing. |
| **Monetisation** | Founder’s Amazon & Mercado Libre affiliate IDs on all links; Google AdSense only on blog pages. | Revenue split with contributors (future phase). |

---

## 4. Core User Stories

1.  **Visitor** lands on the homepage and instantly sees up to 25 fresh MXN-priced deals.
2.  **Admin** scans drafts > 20% discount and publishes 10 deals in under 10 minutes.
3.  **Logged-in user** votes (+/–) on a deal and leaves a Markdown comment that others can vote on.
4.  **Subscriber** receives a Telegram alert when a new deal goes live and clicks through in < 3s.
5.  **Reporter** flags a broken price; after three reports the deal disappears pending review.

---

## 5. Functional Requirements

| ID | Requirement |
| :--- | :--- |
| **FR-01** | Ingestion service skips duplicates (hash on URL) and stores drafts with `status="DRAFT"`. |
| **FR-02** | `/admin/drafts` lists drafts; *Publish* sets `status="LIVE"`, `publishedAt`, triggers notifications. |
| **FR-03** | Public `/api/deals` supports filters `store`, `category`, `price_min`, `price_max`. |
| **FR-04** | Voting (on deals and comments) is idempotent; duplicate vote returns HTTP 409. |
| **FR-05** | Comments max 500 characters, sanitized Markdown. |
| **FR-06** | Telegram notification via `sendMessage` API after each publish. |
| **FR-07** | Nightly digest cron (00:05 UTC-6) emails top-10 deals by score to opted-in users. |
| **FR-08** | Report endpoint increments `reports`; at ≥ 3 sets `status="REVIEW"`. |

---

## 6. Data Model (Prisma snapshot)

```prisma
// Statuses for a deal in its lifecycle
enum DealStatus {
  DRAFT
  LIVE
  REVIEW
  EXPIRED
}

model Deal {
  id          Int       @id @default(autoincrement())
  title       String
  url         String    @unique
  image       String?
  store       String
  price       Decimal   @db.Numeric(10,2)
  oldPrice    Decimal?
  discountPct Int
  status      DealStatus @default(DRAFT)
  publishedAt DateTime?
  authorId    Int?
  reports     Int       @default(0)
  votes       Vote[]
  comments    Comment[]
}

model Vote {
  id     Int @id @default(autoincrement())
  dealId Int
  userId Int
  value  Int      // Application logic must enforce this is +1 or -1
  @@unique([dealId, userId])
}

model Comment {
  id           Int      @id @default(autoincrement())
  dealId       Int
  userId       Int
  content      String
  createdAt    DateTime @default(now())
  commentVotes CommentVote[]
}

model CommentVote {
  id        Int   @id @default(autoincrement())
  commentId Int
  userId    Int
  value     Int      // Application logic must enforce this is +1 or -1
  comment   Comment @relation(fields: [commentId], references: [id])
  user      User    @relation(fields: [userId], references: [id])
  @@unique([commentId, userId])
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  name         String?
  image        String?
  karma        Int      @default(0)
  bannedUntil  DateTime?
  comments     Comment[]
  commentVotes CommentVote[]
}
```

---

## 7. Non-Functional Requirements

| Area | Target |
| :--- | :--- |
| Performance | TTFB < 200 ms (Vercel Edge). |
| SEO | Canonical tags, JSON-LD breadcrumbs, auto OG images. |
| Accessibility | WCAG 2.1 AA. |
| Security | HTTPS only; CSRF on state-changing routes; rate-limit auth (5/min/IP). |
| Availability | 99 % on Vercel Hobby + Supabase free. |

---

## 8. Tech Stack

| Layer | Choice |
| :--- | :--- |
| Frontend | **Next.js** (App Router) + Tailwind + shadcn/ui |
| Backend | Next.js API routes |
| Database / ORM | Postgres (Supabase) + **Prisma** |
| Auth | NextAuth (Email + Google) |
| **Cron / Jobs** | **Vercel Scheduled Functions (default). Alt: GitHub Actions or external cron service (e.g., cron-job.org) hitting a secret API endpoint.** |
| Notifications | Telegram Bot API |
| Email | SendGrid free tier |
| Deployment | Vercel (Hobby plan) **or any Node.js compatible host.** |

---

## 9. Milestones

| Week | Deliverable |
| :--- | :--- |
| 1 | Repo + Next.js scaffold + Supabase schema live. |
| 2 | RSS ingestion (Promodescuentos & Amazon) filling drafts. |
| 3 | Admin curation panel + Telegram push. |
| 4 | Public feed & detail pages. |
| 5 | Auth, voting, comments, karma leaderboard. |
| 6 | Daily email digest + report/ban workflow. |
| 7 | Blog pipeline; publish first 3 SEO posts. |
| 8 | Acquire BajoPrecio.mx domain; soft launch & analytics. |
| **9+** | **Monitor 90-day goals, fix P1 bugs, and iterate on user feedback.** |

---

## 10. Risks & Mitigations

| Risk | Mitigation |
| :--- | :--- |
| Feed formats change | Alert if drafts < 10/run; patch selectors within 24 h. |
| Spam / toxic comments | Rate-limit, first 10 comments moderated, karma-based bans. |
| Amazon sales target not met in 60 d | Run limited ads / social pushes to drive 3 initial sales; add Mercado Libre banners. |
| Keepa cost surpasses revenue | Only activate after Amazon sales ≥ MX$ 13,000 monthly. |

---

### Outstanding item

**Register the domain “BajoPrecio.mx” (or .com) and point it to the hosting provider before soft launch.**